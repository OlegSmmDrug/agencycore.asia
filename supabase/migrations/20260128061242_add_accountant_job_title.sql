/*
  # Добавление должности "Бухгалтер"

  1. Описание изменений
    - Добавляется должность "Бухгалтер" для всех существующих организаций
    - Роль бухгалтера будет доступна для выбора при создании/редактировании пользователей

  2. Безопасность
    - Используется INSERT ... ON CONFLICT для безопасного добавления
    - Должность добавляется только если еще не существует в организации
*/

-- Добавляем должность "Бухгалтер" для всех существующих организаций
INSERT INTO job_titles (title, organization_id, is_active, created_at)
SELECT 
  'Бухгалтер',
  o.id,
  true,
  now()
FROM organizations o
WHERE NOT EXISTS (
  SELECT 1 FROM job_titles jt 
  WHERE jt.title = 'Бухгалтер' 
  AND jt.organization_id = o.id
);